I"³%<h2 id="1-overview">1. Overview</h2>

<p>Apache MaxConnectionsPerChild ê°€ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ëŠ”ì§€ ì‚´í´ë³¸ë‹¤.</p>

<p>Debug Logë¥¼ í†µí•´ì„œë„ ì‚´í´ë³¼ ìˆ˜ ìˆëŠ”ë°, ì´ ë°©ë²•ì€ ë‚˜ì¤‘ì— ì‘ì„±í•˜ê³ </p>

<p>ì—¬ê¸°ì„œëŠ” server-status Pageë¥¼ í†µí•´ í™•ì¸ í•´ë³¸ë‹¤.</p>

<p><br /><br /></p>
<h2 id="2-descriptions">2. Descriptions</h2>

<p>httpd.confëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±í•œë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>&lt;Location /server-status&gt;
    SetHandler server-status
&lt;/Location&gt;

ExtendedStatus On

...

 &lt;IfModule mpm_worker_module&gt;
    StartServers              1
    ServerLimit               1
    MinSpareThreads          25
    MaxSpareThreads          25
    ThreadsPerChild          25
    ThreadLimit              25
    MaxRequestWorkers        25
    MaxConnectionsPerChild   10
    Mutex fcntl:${ORACLE_INSTANCE}/servers/${COMPONENT_NAME}/logs
&lt;/IfModule&gt;
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br />
worker MPMì€ Child Processë¥¼ 1ê°œë§Œ ë¹ˆì•½í•˜ê²Œ ë‘ë„ë¡ í•˜ì—¬, Monitoring ì´ ìš©ì´í•˜ë‹¤.</p>

<p><br />
Debug logë¥¼ ì ê¹ ë³´ë©´, child processëŠ” slot maxê°€ 25ë¡œ í‘œí˜„ëœë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>AH00930: initialized pool in child &lt;PID&gt; for (*) min=0 max=25 smax=25
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br />
/server-status?refresh=1 í˜¸ì¶œ ì‹œ</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>Srv	PID	Acc	M	CPU	SS	Req	Dur	Conn	Child	Slot	Client	Protocol	VHost	Request *This line is HEADER
0-0	2406527	73/73/79	K	0.28	0	2	325	1004.5	0.98	0.99	10.8.125.203	http/1.1	wls.local:10088	GET /server-status?refresh=1 HTTP/1.1
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br />
server-status í˜ì´ì§€ê°€ ê°™ì€ Session ë‚´ì—ì„œ ì§€ì†ì ìœ¼ë¡œ í˜¸ì¶œë˜ì–´,</p>

<p>ACC(73/73/79)</p>

<p>-&gt; í˜„ì¬ Connection(Keep-Alive)ì— 73ë²ˆì§¸ ì—°ì† í˜¸ì¶œ</p>

<p>-&gt; í˜„ì¬ Child Processì— 73ë²ˆì§¸ ì—°ì† í˜¸ì¶œ</p>

<p>-&gt; í˜„ì¬ Child Processë‚´ì— ê°™ì€ Thread(server-status ì—ì„œëŠ” slotìœ¼ë¡œ í‘œí˜„ë¨)ì— 79ë²ˆì§¸ ì—°ì† í˜¸ì¶œ</p>

<p><br />
server-status í˜ì´ì§€ ë™ì‘ ë°©ì‹ìƒ keep-alive timeoutì„ ìœ ë°œí•  ê²½ìš°ëŠ” ì—†ìœ¼ë¯€ë¡œ
ëŒ€ë¶€ë¶„ ê°™ì€ connection/child/slot ì—ì„œ ì²˜ë¦¬ë˜ëŠ”ê²ƒì´ ëª©ê²©ëœë‹¤.</p>

<p><br />
curl ëª…ë ¹ì„ ì´ìš©í•´ connection close ë˜ë¯€ë¡œ í•­ìƒ ìƒˆë¡œìš´ ìš”ì²­ìœ¼ë¡œ ìœ ì…ë˜ëŠ” ê²½ìš°,
(ëª…ë ¹ì–´ëŠ” curl â€“head http://wls.local:10088/MaxConnectionPerChild/Test ë¥¼ ì‚¬ìš©í•œë‹¤.)</p>

<p><br />
child processê°€ ìƒˆë¡œ ë§Œë“¤ì–´ì§„ ì§í›„ì—ëŠ”, Accì˜ Slotì€ ì˜ˆì „ ëˆ„ì ì¹˜ê°€ ê¸°ë¡ë˜ì–´ ìˆê² ì§€ë§Œ, Child(ê°€ìš´ë° ìˆ«ì)ëŠ” 0ìœ¼ë¡œ í•œë²ˆë„ ì‚¬ìš©ë˜ì§€ ì•Šì€ Slotì„ì„ ë³´ì—¬ì¤€ë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>Srv	PID	Acc	M	CPU	SS	Req	Dur	Conn	Child	Slot	Client	Protocol	VHost	Request
0-0	2415459	0/0/40	W	0.00	0	0	132	0.0	0.00	0.24	10.8.125.203	http/1.1	wls.local:10088	GET /server-status?refresh=1 HTTP/1.1
0-0	2415459	0/0/5	_	0.00	2	1	11	0.0	0.00	0.00	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415459	0/0/32	_	0.00	2	1	86	0.0	0.00	0.14	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415459	0/0/17	_	0.00	0	1	45	0.0	0.00	0.09	10.8.125.203	http/1.1	wls.local:10088	GET /server-status?refresh=1 HTTP/1.1
0-0	2415459	0/0/5	_	0.00	2	1	13	0.0	0.00	0.00	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415459	0/0/21	_	0.00	2	1	65	0.0	0.00	0.11	10.8.125.203	http/1.1	wls.local:10088	GET /server-status?refresh=1 HTTP/1.1
0-0	2415459	0/0/5	_	0.00	2	1	26	0.0	0.00	0.00	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415459	0/0/6	_	0.00	2	1	15	0.0	0.00	0.00	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415459	0/0/6	_	0.00	2	2	23	0.0	0.00	0.01	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415459	0/0/7	_	0.00	2	6	18	0.0	0.00	0.00	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415459	0/0/3	_	0.00	2	2	10	0.0	0.00	0.00	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415324	1/1/2	C	0.12	6	0	2	0.0	0.00	0.00	127.0.0.1	http/1.1	localhost:10099	HEAD /dms/ HTTP/1.1    &lt;&lt;&lt;&lt; ê³¼ê±° child process ë¡œ ë³´ì—¬ì§
0-0	2415459	0/0/4	_	0.00	2	1	9	0.0	0.00	0.00	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br />
curl ë¡œ í˜¸ì¶œí–ˆìœ¼ë¯€ë¡œ, ëª¨ë“  slotì´ ì ì  1ë¡œ ì±„ì›Œì§„ë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>0-0	2415459	0/2/42	_	0.05	29	1	139	0.0	0.01	0.25	10.8.125.203	http/1.1	wls.local:10088	GET /server-status?refresh=1 HTTP/1.1
0-0	2415459	12/12/17	W	0.10	0	0	50	81.3	0.08	0.08	10.8.125.203	http/1.1	wls.local:10088	GET /server-status?refresh=1 HTTP/1.1
0-0	2415459	1/1/33	C	0.07	6	0	87	0.0	0.00	0.14	127.0.0.1	http/1.1	localhost:10099	HEAD /dms/ HTTP/1.1
0-0	2415459	0/0/17	_	0.00	30	1	45	0.0	0.00	0.09	10.8.125.203	http/1.1	wls.local:10088	GET /server-status?refresh=1 HTTP/1.1
0-0	2415459	0/1/6	_	0.07	6	1	16	0.0	0.00	0.00	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415459	0/1/22	_	0.08	4	1	68	0.0	0.00	0.11	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415459	0/1/6	_	0.08	3	9	37	0.0	0.00	0.00	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415459	0/1/7	_	0.09	2	1	17	0.0	0.00	0.00	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415459	0/1/7	_	0.11	1	0	24	0.0	0.00	0.01	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415459	0/0/7	_	0.00	32	6	18	0.0	0.00	0.00	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415459	0/0/3	_	0.00	32	2	10	0.0	0.00	0.00	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415459	0/0/2	_	0.00	29	0	2	0.0	0.00	0.00	127.0.0.1	http/1.1	localhost:10099	HEAD /dms/ HTTP/1.1
0-0	2415459	0/0/4	_	0.00	32	1	9	0.0	0.00	0.00	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br />
slot 1ì´ ëª¨ë‘ 10ê°œê°€ ëœ ì§í›„ì—ëŠ” ë°”ë¡œ, child proces ì¬ìƒì„± ëœ ê²ƒìœ¼ë¡œ ë³´ì—¬ì§„ë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>0-0	2415632	0/0/42	W	0.00	0	0	139	0.0	0.00	0.25	10.8.125.203	http/1.1	wls.local:10088	GET /server-status?refresh=1 HTTP/1.1
0-0	2415632	0/0/19	_	0.00	2	1	56	0.0	0.00	0.09	10.8.125.203	http/1.1	wls.local:10088	GET /server-status?refresh=1 HTTP/1.1
0-0	2415632	0/0/33	_	0.00	2	0	87	0.0	0.00	0.14	127.0.0.1	http/1.1	localhost:10099	HEAD /dms/ HTTP/1.1
0-0	2415632	0/0/17	_	0.00	2	1	45	0.0	0.00	0.09	10.8.125.203	http/1.1	wls.local:10088	GET /server-status?refresh=1 HTTP/1.1
0-0	2415632	0/0/6	_	0.00	2	1	16	0.0	0.00	0.00	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415632	0/0/22	_	0.00	2	1	68	0.0	0.00	0.11	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415632	0/0/6	_	0.00	2	9	37	0.0	0.00	0.00	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415632	0/0/7	_	0.00	2	1	17	0.0	0.00	0.00	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415632	0/0/7	_	0.00	2	0	24	0.0	0.00	0.01	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415632	0/0/14	_	0.00	1	1	40	0.0	0.00	0.05	10.8.125.203	http/1.1	wls.local:10088	GET /server-status?refresh=1 HTTP/1.1
0-0	2415632	0/0/5	_	0.00	2	1	14	0.0	0.00	0.00	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
0-0	2415632	0/0/2	_	0.00	2	0	2	0.0	0.00	0.00	127.0.0.1	http/1.1	localhost:10099	HEAD /dms/ HTTP/1.1
0-0	2415632	0/0/5	_	0.00	2	1	11	0.0	0.00	0.00	10.65.34.245	http/1.1	wls.local:10088	HEAD /MaxConnectionPerChild HTTP/1.1
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br />
server-status í˜¸ì¶œê³¼, ë‚´ë¶€ì ìœ¼ë¡œ ê´€ë¦¬ë¥¼ ìœ„í•´ í˜¸ì¶œë˜ëŠ” dms(Dynamic Monitoring Service) ì— ì˜í•´ ì¢€ ë” ì¼ì° slotì´ ì±„ì›Œì§ˆ ìˆ˜ ìˆê² ë‹¤. (ìˆœìˆ˜ Apacheê°€ ì•„ë‹ˆë¼ OHS 12cR2 ì´ë‹¤.)</p>

<p><br />
Keep-Aliveê°€ ì•„ë‹Œ ìš”ì²­ì´ ìœ ì…ëœë‹¤ëŠ” ê°€ì •í•˜ì—, Slotì´ ëª¨ë‘ 1ë¡œ ì±„ì›Œì§„ ë’¤, PIDê°€ ë°”ë€” ê²ƒì´ë‹¤.</p>
:ET