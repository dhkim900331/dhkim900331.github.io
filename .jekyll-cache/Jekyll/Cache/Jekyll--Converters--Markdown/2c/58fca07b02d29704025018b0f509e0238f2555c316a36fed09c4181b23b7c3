I"®Ì<h2 id="1-overview">1. Overview</h2>

<p>Coherence 14c í…ŒìŠ¤íŠ¸ í™˜ê²½ì„ ìœ„í•´ ê¸°ë³¸ ì„¤ì¹˜ í™˜ê²½ì„ ì§‘ì•½í•œë‹¤.</p>
<p style="height:20px;"></p>
<h2 id="2-descriptions">2. Descriptions</h2>

<p>ë‹¤ìŒ í™˜ê²½ì„ êµ¬ì„±í•˜ë„ë¡ í•œë‹¤.</p>

<ul>
  <li>cluster-base_domain
    <ul>
      <li>Coherence Server, TCP 9000 ~ 9100</li>
      <li>Managed Coherence Server, TCP 9000</li>
    </ul>
    <p style="height:20px;"></p>
  </li>
</ul>

<p>ì•„ë˜ ë¬¸ì„œì—ì„œëŠ” Coherence-Serverë¥¼ Cache-Server,</p>

<p>Managed Coherence Server(WLS+Coherence Module)ë¥¼ Cache-Client ë¼ê³  í‘œí˜„í•˜ê¸°ë„ í–ˆë‹¤.</p>

<p>WLS ë˜í•œ ìê¸° ìì‹ ì´ Cache-Serverê°€ ë  ìˆ˜ ìˆìœ¼ë‚˜, Coherenceì„ ì‚¬ìš©í•˜ëŠ” ëª©ì ì€ WLS ì—ì„œëŠ” Dataë¥¼ ì²˜ë¦¬í•˜ì§€ ì•ŠëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì´ë‹¤.</p>
<p style="height:20px;"></p>

<h3 id="21-downloads">2.1 Downloads</h3>

<p><a href="https://edelivery.oracle.com">Oracle Software Delivery Cloud</a> ì—ì„œ Download í•  List</p>

<ul>
  <li>Oracle Coherence 14.1.1.0.0 (124.3 MB)</li>
</ul>

<h2 id="3-script">3. Script</h2>

<h3 id="31-engine">3.1 Engine</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre></td><td class="rouge-code"><pre><span class="nv">BASEDIR</span><span class="o">=</span>/sw/installFiles
<span class="nv">OS_USERNAME</span><span class="o">=</span><span class="si">$(</span><span class="nb">id</span> <span class="nt">--user</span> <span class="nt">--name</span><span class="si">)</span>
<span class="nv">OS_GROUPNAME</span><span class="o">=</span><span class="si">$(</span><span class="nb">id</span> <span class="nt">--group</span> <span class="nt">--name</span><span class="si">)</span>

<span class="nv">COH_INSTALL_FILE</span><span class="o">=</span><span class="k">${</span><span class="nv">BASEDIR</span><span class="k">}</span>/fmw_14.1.1.0.0_coherence.jar
<span class="nv">JAVA_HOME</span><span class="o">=</span>/sw/jdk/jdk1.8.0_351

<span class="nv">COH_INSTALL_PATH</span><span class="o">=</span>/sw/coherence/14c
<span class="nv">INVENTORY_PATH</span><span class="o">=</span>/sw/coherence/inventories/14c
<span class="nv">INVENTORY_GROUP</span><span class="o">=</span><span class="k">${</span><span class="nv">OS_GROUPNAME</span><span class="k">}</span>

<span class="nv">DOMAIN_NAME</span><span class="o">=</span>base_domain
<span class="nv">DOMAIN_HOME</span><span class="o">=</span><span class="k">${</span><span class="nv">COH_INSTALL_PATH</span><span class="k">}</span>/domains/<span class="k">${</span><span class="nv">DOMAIN_NAME</span><span class="k">}</span>

<span class="nv">CS_ADDR</span><span class="o">=</span>wls.local
<span class="nv">CS_PORT</span><span class="o">=</span>9000
<span class="nv">CS_PORT_ADJUST</span><span class="o">=</span>100


<span class="c"># (1) ResponseFile</span>
<span class="c"># https://docs.oracle.com/en/middleware/fusion-middleware/12.2.1.4/ouirf/sample-response-files-silent-installation-and-deinstallation.html#GUID-65B11C03-B559-41F1-B9B4-B7276491E580</span>
<span class="c"># INSTALL_TYPE is one of fmw_14.1.1.0.0_coherence.jar:/Disk1/stage/distributions/Coherence_14.1.1.0.0.xml</span>

<span class="nb">cat</span> <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh"> &gt; </span><span class="k">${</span><span class="nv">BASEDIR</span><span class="k">}</span><span class="sh">/rsp
[ENGINE]
Response File Version=1.0.0.0.0
 
[GENERIC]
DECLINE_AUTO_UPDATES=true
ORACLE_HOME=</span><span class="k">${</span><span class="nv">COH_INSTALL_PATH</span><span class="k">}</span><span class="sh">
INSTALL_TYPE=Typical
</span><span class="no">EOF


</span><span class="c"># (2) Inventory</span>
<span class="c"># https://docs.oracle.com/en/middleware/fusion-middleware/12.2.1.4/ouirf/using-oracle-universal-installer-silent-mode.html#GUID-756E3FD9-4094-412F-9BEB-72C5FD51056B</span>
<span class="c"># * inventory.loc íŒŒì¼ ìƒ˜í”Œì€ ë¬¸ì„œì— ì—†ìŒ</span>

<span class="nb">cat</span> <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh"> &gt; </span><span class="k">${</span><span class="nv">BASEDIR</span><span class="k">}</span><span class="sh">/loc
inventory_loc=</span><span class="k">${</span><span class="nv">INVENTORY_PATH</span><span class="k">}</span><span class="sh">
inst_group=</span><span class="k">${</span><span class="nv">INVENTORY_GROUP</span><span class="k">}</span><span class="sh">
</span><span class="no">EOF


</span><span class="c"># (3) Installation</span>
<span class="c"># https://docs.oracle.com/en/middleware/fusion-middleware/12.2.1.4/ouirf/using-oracle-universal-installer-silent-mode.html#GUID-5F06D02F-6D71-45B9-BF41-5D5759D31958</span>

<span class="k">${</span><span class="nv">JAVA_HOME</span><span class="k">}</span>/bin/java <span class="nt">-jar</span> <span class="k">${</span><span class="nv">COH_INSTALL_FILE</span><span class="k">}</span> <span class="nt">-silent</span> <span class="nt">-responseFile</span> <span class="k">${</span><span class="nv">BASEDIR</span><span class="k">}</span>/rsp <span class="nt">-invPtrLoc</span> <span class="k">${</span><span class="nv">BASEDIR</span><span class="k">}</span>/loc
</pre></td></tr></tbody></table></code></pre></div></div>
<p style="height:20px;"></p>
<h3 id="32-cache-configuration">3.2 Cache Configuration</h3>

<p>Cluster ë‚´ì—ì„œ ìœ ì§€í•  Cache ì— ëŒ€í•œ ê¸°ë³¸ ì†ì„±ì„ ì •ì˜í•  ìˆ˜ ìˆë‹¤.</p>

<p>í•´ë‹¹ íŒŒì¼ì€ Cache-Server, Cache-Client ëª¨ë‘ì—ì„œ ì‚¬ìš©ëœë‹¤.</p>

<p>XML íŒŒì¼ì€ í•œ ë²ˆë§Œ ì •ì˜ë˜ê³  ì“°ì´ë©´ ëª¨ë‘ê°€ ë§Œì¡±í•´ì•¼ ë  ê²ƒìœ¼ë¡œ ì´í•´í–ˆëŠ”ë°, ê³µì‹ ê°€ì´ë“œë¥¼ ë”°ë¼ê°€ë³´ë©´ Serverì™€ Client, ê·¸ë¦¬ê³  Client(WLS)ì— ë°°í¬ëœ App ë‚´ì—ì„œë„ ì‚¬ìš©ëœë‹¤.</p>

<p>ì—¬ê¸°ì €ê¸°ì„œ ì‚¬ìš©ë˜ëŠ” ê²ƒì´ ë§ëŠ”ì§€ì— ëŒ€í•œ ê²ƒ ë•Œë¬¸ì— í˜¼ë™ì´ ì¢€ ìˆì—ˆëŠ”ë°,</p>

<p>Appì—ì„œ ìƒì„±í•˜ëŠ” CacheëŠ” Cache-Serverì—ì„œë„, Cache-Clientì—ì„œë„ ëª¨ë‘ ìœ ì§€ë˜ê¸° ìœ„í•´ì„œ ê¸°ë³¸ Cache êµ¬ì„±ì— ëŒ€í•œ ì •ì˜ê°€ ìˆì–´ì•¼ ë˜ê¸° ë•Œë¬¸ì— ì–‘ìª½ì— ë™ì¼í•œ íŒŒì¼ì´ ìˆì–´ì•¼ í•˜ëŠ” ê²ƒìœ¼ë¡œ <del>ê·¸ëƒ¥</del> ì´í•´í–ˆë‹¤.</p>
<p style="height:20px;"></p>
<ul>
  <li>
    <p><a href="https://docs.oracle.com/en/middleware/standalone/coherence/14.1.1.0/administer-http-sessions/using-coherenceweb-weblogic-server.html#GUID-24BDEA82-1E53-47F2-BD2B-E573639DADB5">Overview of Coherence*Web</a></p>

    <ul>
      <li>
        <p>coherence.jar, coherence-web.jar íŒŒì¼ì´ ê³µìœ  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ë°°í¬ë˜ê±°ë‚˜, Web application libì— ìœ„ì¹˜í•´ì•¼ í•œë‹¤.</p>

        <blockquote>
          <p>Web-App ì•„ë˜ì— ë°°í¬ë˜ëŠ” ê²½ìš°, Heap resource ë‚­ë¹„ë„ ìˆê±°ë‹ˆì™€ Operational XML íŒŒì¼ì„ Loadí•˜ëŠ”ë°ë„ ë¬¸ì œê°€ ìˆìœ¼ë¯€ë¡œ ì‚¬ì‹¤ìƒ Shared Library($DOMAIN_HOME/lib)ì— ë°°í¬í•´ì•¼ í•œë‹¤.</p>
        </blockquote>
      </li>
      <li>
        <p>ê¸°ë³¸ Cache êµ¬ì„± íŒŒì¼ì€, coherence-web.jar ì— default-session-cache-config.xml ê°€ ìˆë‹¤.</p>

        <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>jar <span class="nt">-xf</span> coherence-web.jar default-session-cache-config.xml
<span class="nv">$ </span><span class="nb">mv </span>default-session-cache-config.xml session-cache-config.xml
</pre></td></tr></tbody></table></code></pre></div>        </div>

        <blockquote>
          <p>í•´ë‹¹ íŒŒì¼ì„ ì¶”ì¶œí•˜ì—¬, Coherence , WLS, App ë‚´ì—ì„œ ë‹¤ì–‘í•˜ê²Œ ì‚¬ìš©ëœë‹¤.</p>
        </blockquote>
      </li>
      <li>
        <p><a href="https://docs.oracle.com/en/middleware/standalone/coherence/14.1.1.0/administer-http-sessions/using-coherenceweb-weblogic-server.html#GUID-16EF76E3-D55A-4823-8035-81873199E796">Using a Custom Session Cache Configuration File</a>)ì— ë”°ë¼ ê¸°ë³¸ Cache êµ¬ì„± íŒŒì¼ì„ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.</p>
      </li>
      <li>
        <p>ê¸°ë³¸ Cache êµ¬ì„± íŒŒì¼ì€, WEB-INF/classes ì— ë°°ì¹˜í•œë‹¤. ì—†ìœ¼ë©´, coherence-web.jarì—ì„œ default-session-cache-config.xml ì„ ë¡œë“œí•œë‹¤.</p>

        <blockquote>
          <p>coherence-web.jar ë¥¼ App/lib ë‚´ì— ë°°í¬í•˜ì§€ ì•Šìœ¼ë©´ Cache êµ¬ì„± íŒŒì¼ì„ Load í•˜ì§€ ì•Šì•„ ì—ëŸ¬ê°€ ìˆë‹¤, xml ì„ ë°˜ë“œì‹œ ë°°í¬í•˜ê±°ë‚˜, jar íŒŒì¼ì„ Shared Library ê°€ ì•„ë‹Œ, App/lib ì— ë°°í¬ í•´ì•¼ í•œë‹¤.</p>
        </blockquote>
      </li>
      <li>
        <p>ìœ„ ì„¤ëª…ì—ì„œ, ê¸°ë³¸ Cache êµ¬ì„± íŒŒì¼ ì´ë¦„ ë³€ê²½(session-cache-config.xml ì´ë¦„ì´ ì•„ë‹Œ)í•˜ì—¬ web.xml ì—ì„œ ê²½ë¡œë¥¼ ì…ë ¥ ê°€ëŠ¥í•˜ë‹¤ê³  í•˜ì§€ë§Œ ë¬¸ì„œ ë²„ê·¸ì¸ì§€ ë°©ë²•ì´ ë‚˜íƒ€ë‚˜ ìˆì§€ ì•Šë‹¤. Option ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.</p>

        <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>coherence.cache.configuration.path<span class="o">=</span>xml
</pre></td></tr></tbody></table></code></pre></div>        </div>

        <blockquote>
          <p>ë°°í¬í•œ Appì´ í•œ ê°œ ë¿ì´ë¼ë©´ ìœ ìš©í•˜ê² ìœ¼ë‚˜, ì¼ë°˜ì ìœ¼ë¡œ ê·¸ë ‡ì§€ ì•Šìœ¼ë‹ˆ classes ì— session-cache-config.xml ë„£ëŠ” ê²ƒì´ ê°•ì œë  ìˆ˜ ìˆê² ë‹¤.</p>
        </blockquote>
      </li>
      <li>
        <p>ê¸°ë³¸ì ìœ¼ë¡œ local-storageê°€ falseë¡œ ì„¤ì •ë˜ì–´ ìˆê¸° ë•Œë¬¸ì—, XMLì„ ìˆ˜ì •í•˜ê±°ë‚˜ Optionì„ ì„¤ì •í•œë‹¤. Cache-Clientì—ì„œëŠ” falseë¥¼ ì‚¬ìš©í•˜ë©´ ë˜ê² ë‹¤.</p>

        <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>coherence.session.localstorage<span class="o">=</span><span class="nb">true</span>
</pre></td></tr></tbody></table></code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ul>
<p style="height:20px;"></p>
<p>ì—¬ê¸°ì„œ ì–¸ê¸‰í•œ coherence.jar, coherence-web.jar, session-cache-config.xml íŒŒì¼ì€ Cache-Server, Cache-Client ì—ì„œ ëª¨ë‘ ì‚¬ìš©ë˜ë¯€ë¡œ ê° ë””ë ‰í† ë¦¬ë¡œ ì ì ˆíˆ ë³µì‚¬ê°€ ë˜ì–´ì•¼ í•œë‹¤.</p>

<p>ì•„ë˜ëŠ”, ì•ìœ¼ë¡œ ìš°ë¦¬ê°€ êµ¬ì¶•í•  WLSì™€ Coherence Domain ë””ë ‰í† ë¦¬ì— ë³µì œë  íŒŒì¼ ëª©ë¡ë“¤ì´ë‹¤.</p>

<blockquote>
  <p><a href="#h-321-cluster">3.2.1 Cluster</a>ì„ ë¨¼ì € ìˆ˜í–‰í•œë‹¤.</p>
</blockquote>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c"># Cache-Clientê°€ ë  WLS ì— ë³µì‚¬</span>
<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-al</span> &lt;WEBLOGIC-DOMAIN-HOME&gt;/lib/<span class="k">*</span>
<span class="nt">-rw-r-----</span> 1 wasadm wasadm 13763107 Apr 20 15:29 coherence.jar
<span class="nt">-rw-r-----</span> 1 wasadm wasadm   241893 Apr 20 15:29 coherence-web.jar
<span class="nt">-rw-rw-r--</span> 1 wasadm wasadm     4337 Apr 20 15:38 session-cache-config.xml

<span class="c"># Cache-Serverê°€ ë  Coherence ì— ë³µì‚¬</span>
<span class="nv">$ </span><span class="nb">cd</span> &lt;COHERENCE-DOMAIN-HOME&gt;/lib/
<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-al</span> coherence.jar coherence-web.jar session-cache-config.xml
<span class="nt">-rw-r-----</span> 1 wasadm wasadm 13763107 Mar 26  2020 coherence.jar
<span class="nt">-rw-r-----</span> 1 wasadm wasadm   241893 Mar 26  2020 coherence-web.jar
<span class="nt">-rw-rw-r--</span> 1 wasadm wasadm     4337 Apr 20 15:24 session-cache-config.xml
</pre></td></tr></tbody></table></code></pre></div></div>
<p style="height:20px;"></p>
<h3 id="32-cache-server">3.2 Cache-Server</h3>

<h4 id="321-cluster">3.2.1 Cluster</h4>

<p>Coherence êµ¬ì„±ì„ ìœ„í•´ì„œëŠ” ë§ì€ ì„¤ì • ê°’ì´ í•„ìš”í•˜ì§€ë§Œ, <a href="https://docs.oracle.com/en/middleware/standalone/coherence/14.1.1.0/develop-applications/understanding-configuration.html#GUID-8387E29A-EE03-4075-B4E7-D92779335965">Using the Default Operational Override File</a> ë°©ì‹ì„ ì‚¬ìš©í•˜ì—¬, ì¼ë¶€ë¶„ ì„¤ì •ê°’ë§Œ override í•˜ë„ë¡ í•œë‹¤.</p>
<p style="height:20px;"></p>
<p><a href="https://docs.oracle.com/en/middleware/standalone/coherence/14.1.1.0/develop-applications/understanding-configuration.html#GUID-1C518560-021D-4F55-ACC4-C0E10133D45A">Specifying an Operational Override File</a> ì— ì„¤ëª…ëœ <code class="language-plaintext highlighter-rouge">-Dcoherence.override</code> ì˜µì…˜ìœ¼ë¡œ ì•„ë˜ ì„¤ì • íŒŒì¼ì„ ì‚¬ìš©í•  ê²ƒì´ë‹¤.</p>
<p style="height:20px;"></p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre></td><td class="rouge-code"><pre><span class="c"># (4) Cluster Member</span>
<span class="c"># Cache Serverì—ëŠ” WLS Domainê³¼ ê°™ì€ ê°œë…ì´ ì—†ìœ¼ë‚˜, ì„ì˜ë¡œ ë§Œë“¬</span>

<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/logs
<span class="nb">cp</span> <span class="nt">-pR</span> <span class="k">${</span><span class="nv">COH_INSTALL_PATH</span><span class="k">}</span>/coherence/lib <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>

<span class="c"># https://docs.oracle.com/en/middleware/standalone/coherence/14.1.1.0/develop-applications/setting-cluster.html#GUID-E3DCA888-1155-4E95-BDC7-668719C86F69</span>

<span class="nb">cat</span> <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh"> &gt; </span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span><span class="sh">/lib/tangosol-coherence-</span><span class="k">${</span><span class="nv">DOMAIN_NAME</span><span class="k">}</span><span class="sh">.xml
&lt;?xml version='1.0'?&gt;
&lt;coherence xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://xmlns.oracle.com/coherence/coherence-operational-config" xsi:schemaLocation="http://xmlns.oracle.com/coherence/coherence-operational-config.xsd"&gt;
   
  &lt;cluster-config&gt;
    &lt;member-identity&gt;
      &lt;cluster-name system-property="coherence.cluster"&gt;cluster_</span><span class="k">${</span><span class="nv">DOMAIN_NAME</span><span class="k">}</span><span class="sh">&lt;/cluster-name&gt;
      &lt;site-name    system-property="coherence.site"&gt;site_</span><span class="k">${</span><span class="nv">DOMAIN_NAME</span><span class="k">}</span><span class="sh">&lt;/site-name&gt;
      &lt;rack-name    system-property="coherence.rack"&gt;rack_</span><span class="k">${</span><span class="nv">DOMAIN_NAME</span><span class="k">}</span><span class="sh">&lt;/rack-name&gt;
      &lt;machine-name system-property="coherence.machine"&gt;machine_</span><span class="k">${</span><span class="nv">DOMAIN_NAME</span><span class="k">}</span><span class="sh">&lt;/machine-name&gt;
      &lt;process-name system-property="coherence.process"&gt;process_</span><span class="k">${</span><span class="nv">DOMAIN_NAME</span><span class="k">}</span><span class="sh">&lt;/process-name&gt;
      &lt;member-name  system-property="coherence.member"&gt;member_</span><span class="k">${</span><span class="nv">DOMAIN_NAME</span><span class="k">}</span><span class="sh">&lt;/member-name&gt;
      &lt;role-name    system-property="coherence.role"&gt;CoherenceServer&lt;/role-name&gt;
      &lt;priority     system-property="coherence.priority"&gt;5&lt;/priority&gt;
    &lt;/member-identity&gt;
  
    &lt;unicast-listener&gt; 
      &lt;address system-property="coherence.localhost"&gt;</span><span class="k">${</span><span class="nv">CS_ADDR</span><span class="k">}</span><span class="sh">&lt;/address&gt;
      &lt;port system-property="coherence.localport"&gt;</span><span class="k">${</span><span class="nv">CS_PORT</span><span class="k">}</span><span class="sh">&lt;/port&gt;
      &lt;port-auto-adjust system-property="coherence.localport.adjust"&gt;</span><span class="k">$((</span>CS_PORT+CS_PORT_ADJUST<span class="k">))</span><span class="sh">&lt;/port-auto-adjust&gt;

      &lt;well-known-addresses&gt; 
        &lt;address id="1" system-property="coherence.wka"&gt;</span><span class="k">${</span><span class="nv">CS_ADDR</span><span class="k">}</span><span class="sh">&lt;/address&gt; 
        &lt;!--&lt;address id="2" system-property="coherence.wka2"&gt;</span><span class="k">${</span><span class="nv">CS_ADDR</span><span class="k">}</span><span class="sh">&lt;/address&gt;--&gt;
      &lt;/well-known-addresses&gt;
    &lt;/unicast-listener&gt;
     
    &lt;tcp-ring-listener&gt;
      &lt;enabled&gt;true&lt;/enabled&gt;
      &lt;ip-timeout system-property="coherence.ipmonitor.pingtimeout"&gt;25s&lt;/ip-timeout&gt;
      &lt;ip-attempts&gt;5&lt;/ip-attempts&gt;
      &lt;listen-backlog&gt;10&lt;/listen-backlog&gt;
    &lt;/tcp-ring-listener&gt;

    &lt;packet-publisher&gt;
      &lt;packet-delivery&gt;
        &lt;heartbeat-milliseconds&gt;5000&lt;/heartbeat-milliseconds&gt;
      &lt;/packet-delivery&gt;
    &lt;/packet-publisher&gt;
  &lt;/cluster-config&gt;
&lt;/coherence&gt;
</span><span class="no">EOF
</span></pre></td></tr></tbody></table></code></pre></div></div>
<p style="height:20px;"></p>
<p><a href="#h-322-startup-cache-server">3.2.2 Startup Cache-Server</a>ì—ì„œ ì„¤ëª…í•˜ë“¯ì´, ìš°ë¦¬ê°€ ìƒì„±í•œ <code class="language-plaintext highlighter-rouge">tangosol-coherence-${DOMAIN_NAME}.xml</code> íŒŒì¼ì€ ë‹¤ìŒ ì²˜ëŸ¼ Optionì´ ì„¤ì •ë˜ì–´ì•¼ í•œë‹¤.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nt">-Dcoherence</span>.override<span class="o">=</span>tangosol-coherence-override-<span class="k">${</span><span class="nv">DOMAIN_NAME</span><span class="k">}</span>.xml
<span class="nv">CLASSPATH</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">CLASSPATH</span><span class="k">}</span><span class="s2">:</span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span><span class="s2">/lib
</span></pre></td></tr></tbody></table></code></pre></div></div>
<p style="height:20px;"></p>
<p>CLASSPATH ì— ìˆëŠ” xml íŒŒì¼ì„ override í•  ìˆ˜ ìˆë‹¤.</p>
<p style="height:20px;"></p>
<h4 id="322-startup-cache-server">3.2.2 Startup Cache-Server</h4>

<ul>
  <li><a href="https://docs.oracle.com/en/middleware/standalone/coherence/14.1.1.0/administer-http-sessions/using-coherenceweb-weblogic-server.html#GUID-D8120C85-FCD3-491E-8618-03B691279797">Start a Cache Server</a>
    <ul>
      <li>Coherence ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ WLS í•˜ìœ„ subsystemìœ¼ë¡œ (ì¦‰ ê°™ì€ JVM) ìœ ì§€ë˜ë©´, WLSì™€ ê°™ì€ lifecycleì„ ê³µìœ í•œë‹¤. ì´ëŸ¬í•œ ê²½ìš° Managed Coherence Server ë¼ê³  ë¶€ë¥¸ë‹¤.</li>
    </ul>
    <p style="height:20px;"></p>
  </li>
  <li>
    <p><a href="https://docs.oracle.com/en/middleware/standalone/coherence/14.1.1.0/administer-http-sessions/using-coherenceweb-weblogic-server.html#GUID-E65D5FAC-B517-4F59-8AF7-8458AE1216C1">To Start a Standalone Coherence Cache Server</a></p>

    <ul>
      <li>
        <p>Cache Serverë¥¼ ë…ë¦½ ì‹¤í–‰, ì•„ë˜ì—ì„œ ì´ ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” Scriptë¥¼ ì„¤ëª…í–ˆë‹¤.</p>
      </li>
      <li>
        <p>ë¬¸ì„œ ìƒì—ëŠ”, <code class="language-plaintext highlighter-rouge">coherence.cacheconfig</code> íŒŒì¼ì˜ ì ˆëŒ€ê²½ë¡œë¥¼ ì‚¬ìš©í•˜ë¼ê³  ë˜ì–´ ìˆì§€ë§Œ, CLASSPATH ì—ì„œ ê°€ì ¸ì˜¤ëŠ” ê²ƒìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ë˜ë¯€ë¡œ ì•„ë˜ì™€ ê°™ì´ ì¡°ì¹˜í•´ì•¼ í•œë‹¤.</p>

        <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nt">-Dcoherence</span>.cacheconfig<span class="o">=</span>session-cache-config.xml
<span class="nv">CLASSPATH</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">CLASSPATH</span><span class="k">}</span><span class="s2">:</span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span><span class="s2">/lib
</span></pre></td></tr></tbody></table></code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ul>

<p>ì•„ë˜ ìŠ¤í¬ë¦½íŠ¸ëŠ” Cache-Server 2ê°œë¥¼ ìƒì„±í•œë‹¤.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
</pre></td><td class="rouge-code"><pre><span class="c"># (5) Create Cache-Server Script</span>
<span class="c"># https://docs.oracle.com/en/middleware/standalone/coherence/14.1.1.0/administer-http-sessions/using-coherenceweb-weblogic-server.html#GUID-ECE861D6-450C-494C-8DD7-E9AA15AFF6E3</span>

<span class="nb">cat</span> <span class="o">&lt;&lt;</span> <span class="sh">"</span><span class="no">EOF</span><span class="sh">" &gt; </span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span><span class="sh">/startCS.sh
#!/bin/sh
JAVA_HOME=#JAVA_HOME#
DOMAIN_NAME=#DOMAIN_NAME#
DOMAIN_HOME=#DOMAIN_HOME#
SERVER_NAME=#SERVER_NAME#

LOG_HOME=</span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span><span class="sh">/logs
NOHUP_LOG=</span><span class="k">${</span><span class="nv">LOG_HOME</span><span class="k">}</span><span class="sh">/nohup
GC_LOG=</span><span class="k">${</span><span class="nv">LOG_HOME</span><span class="k">}</span><span class="sh">/gc
HEAPDUMP_DIR=</span><span class="k">${</span><span class="nv">LOG_HOME</span><span class="k">}</span><span class="sh">/heapdump
LOG_TIME=</span><span class="si">$(</span><span class="nb">date</span> +%y%m%d_%H%M<span class="si">)</span><span class="sh">

##### Make Path #####
mkdir -p </span><span class="k">${</span><span class="nv">LOG_HOME</span><span class="k">}</span><span class="sh"> </span><span class="k">${</span><span class="nv">NOHUP_LOG</span><span class="k">}</span><span class="sh"> </span><span class="k">${</span><span class="nv">GC_LOG</span><span class="k">}</span><span class="sh"> </span><span class="k">${</span><span class="nv">HEAPDUMP_DIR</span><span class="k">}</span><span class="sh">
###################

##### User Check #####
USER=#OS_USERNAME#
if [ "</span><span class="nv">$USER</span><span class="sh">" != </span><span class="si">$(</span>/usr/bin/whoami<span class="si">)</span><span class="sh"> ]; then
     echo "* you do not have permission. *"
     exit;
fi
####################

## Process Check ##
COH_PID=</span><span class="si">$(</span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/ps<span class="k">${</span><span class="nv">SERVER_NAME</span><span class="k">}</span>.sh<span class="si">)</span><span class="sh">
if [ "</span><span class="nv">$COH_PID</span><span class="sh">" != "" ]; then
     echo "Server already Started."
     exit;
fi
###################

##### gc log rotation #####
mv </span><span class="k">${</span><span class="nv">GC_LOG</span><span class="k">}</span><span class="sh">/gc_</span><span class="k">${</span><span class="nv">SERVER_NAME</span><span class="k">}</span><span class="sh">.out </span><span class="k">${</span><span class="nv">GC_LOG</span><span class="k">}</span><span class="sh">/gc_</span><span class="k">${</span><span class="nv">SERVER_NAME</span><span class="k">}</span><span class="sh">.out.</span><span class="k">${</span><span class="nv">LOG_TIME</span><span class="k">}</span><span class="sh">
USER_MEM_ARGS="</span><span class="k">${</span><span class="nv">USER_MEM_ARGS</span><span class="k">}</span><span class="sh"> -verbose:gc -Xloggc:</span><span class="k">${</span><span class="nv">GC_LOG</span><span class="k">}</span><span class="sh">/gc_</span><span class="k">${</span><span class="nv">SERVER_NAME</span><span class="k">}</span><span class="sh">.out"
######################

##### Heap dump #####
USER_MEM_ARGS="</span><span class="k">${</span><span class="nv">USER_MEM_ARGS</span><span class="k">}</span><span class="sh"> -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=</span><span class="k">${</span><span class="nv">HEAPDUMP_DIR</span><span class="k">}</span><span class="sh">"
####################

USER_MEM_ARGS="</span><span class="k">${</span><span class="nv">USER_MEM_ARGS</span><span class="k">}</span><span class="sh"> -server"
USER_MEM_ARGS="</span><span class="k">${</span><span class="nv">USER_MEM_ARGS</span><span class="k">}</span><span class="sh"> -D</span><span class="k">${</span><span class="nv">SERVER_NAME</span><span class="k">}</span><span class="sh">"
USER_MEM_ARGS="</span><span class="k">${</span><span class="nv">USER_MEM_ARGS</span><span class="k">}</span><span class="sh"> -Xms1024m -Xmx1024m -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=128m"
USER_MEM_ARGS="</span><span class="k">${</span><span class="nv">USER_MEM_ARGS</span><span class="k">}</span><span class="sh"> -Djava.net.preferIPv4Stack=true -Djava.net.preferIPv6Addresses=false"
export USER_MEM_ARGS

COHERENCE_ARGS="</span><span class="k">${</span><span class="nv">COHERENCE_ARGS</span><span class="k">}</span><span class="sh"> -Dcoherence.mode=prod"
COHERENCE_ARGS="</span><span class="k">${</span><span class="nv">COHERENCE_ARGS</span><span class="k">}</span><span class="sh"> -Dcoherence.cacheconfig=session-cache-config.xml"
COHERENCE_ARGS="</span><span class="k">${</span><span class="nv">COHERENCE_ARGS</span><span class="k">}</span><span class="sh"> -Dcoherence.override=tangosol-coherence-</span><span class="k">${</span><span class="nv">DOMAIN_NAME</span><span class="k">}</span><span class="sh">.xml"
COHERENCE_ARGS="</span><span class="k">${</span><span class="nv">COHERENCE_ARGS</span><span class="k">}</span><span class="sh"> -Dcoherence.session.localstorage=true"
COHERENCE_ARGS="</span><span class="k">${</span><span class="nv">COHERENCE_ARGS</span><span class="k">}</span><span class="sh"> -Dcoherence.management.remote=true"
export COHERENCE_ARGS

CLASSPATH="</span><span class="k">${</span><span class="nv">CLASSPATH</span><span class="k">}</span><span class="sh">:</span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span><span class="sh">/lib"
CLASSPATH="</span><span class="k">${</span><span class="nv">CLASSPATH</span><span class="k">}</span><span class="sh">:</span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span><span class="sh">/lib/coherence-web.jar"
CLASSPATH="</span><span class="k">${</span><span class="nv">CLASSPATH</span><span class="k">}</span><span class="sh">:</span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span><span class="sh">/lib/coherence.jar"
export CLASSPATH

mv </span><span class="k">${</span><span class="nv">NOHUP_LOG</span><span class="k">}</span><span class="sh">/</span><span class="k">${</span><span class="nv">SERVER_NAME</span><span class="k">}</span><span class="sh">.out </span><span class="k">${</span><span class="nv">NOHUP_LOG</span><span class="k">}</span><span class="sh">/</span><span class="k">${</span><span class="nv">SERVER_NAME</span><span class="k">}</span><span class="sh">.out.</span><span class="k">${</span><span class="nv">LOG_TIME</span><span class="k">}</span><span class="sh">
nohup </span><span class="k">${</span><span class="nv">JAVA_HOME</span><span class="k">}</span><span class="sh">/bin/java </span><span class="k">${</span><span class="nv">USER_MEM_ARGS</span><span class="k">}</span><span class="sh"> </span><span class="k">${</span><span class="nv">COHERENCE_ARGS</span><span class="k">}</span><span class="sh"> -cp </span><span class="k">${</span><span class="nv">CLASSPATH</span><span class="k">}</span><span class="sh"> com.tangosol.net.DefaultCacheServer &gt; </span><span class="k">${</span><span class="nv">NOHUP_LOG</span><span class="k">}</span><span class="sh">/</span><span class="k">${</span><span class="nv">SERVER_NAME</span><span class="k">}</span><span class="sh">.out 2&gt;&amp;1 &amp;
</span><span class="no">EOF


</span><span class="nb">cat</span> <span class="o">&lt;&lt;</span> <span class="sh">"</span><span class="no">EOF</span><span class="sh">" &gt; </span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span><span class="sh">/psCS.sh
#!/bin/sh
DOMAIN_HOME=#DOMAIN_HOME#
SERVER_NAME=#SERVER_NAME#

ps -ef | grep "java" | grep "com.tangosol.net.DefaultCacheServer" | grep "</span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span><span class="sh">" | grep "D</span><span class="k">${</span><span class="nv">SERVER_NAME</span><span class="k">}</span><span class="sh">"
</span><span class="no">EOF


</span><span class="nb">cat</span> <span class="o">&lt;&lt;</span> <span class="sh">"</span><span class="no">EOF</span><span class="sh">" &gt; </span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span><span class="sh">/stopCS.sh
#!/bin/sh
DOMAIN_HOME=#DOMAIN_HOME#
SERVER_NAME=#SERVER_NAME#

##### User Check #####
USER=#OS_USERNAME#
if [ "</span><span class="nv">$USER</span><span class="sh">" != </span><span class="si">$(</span>/usr/bin/whoami<span class="si">)</span><span class="sh"> ]; then
     echo "* you do not have permission. *"
     exit;
fi
####################

## Process Check ##
COH_PID=</span><span class="si">$(</span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/ps<span class="k">${</span><span class="nv">SERVER_NAME</span><span class="k">}</span>.sh<span class="si">)</span><span class="sh">
if [ "</span><span class="nv">$COH_PID</span><span class="sh">" == "" ]; then
     echo "Server already Stopped."
     exit;
fi
###################

kill -9 </span><span class="si">$(</span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/ps<span class="k">${</span><span class="nv">SERVER_NAME</span><span class="k">}</span>.sh | <span class="nb">awk</span> <span class="s1">'{print $2}'</span><span class="si">)</span><span class="sh">
</span><span class="no">EOF


</span><span class="nb">cat</span> <span class="o">&lt;&lt;</span> <span class="sh">"</span><span class="no">EOF</span><span class="sh">" &gt; </span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span><span class="sh">/logCS.sh
#!/bin/sh
DOMAIN_NAME=#DOMAIN_NAME#
DOMAIN_HOME=#DOMAIN_HOME#
SERVER_NAME=#SERVER_NAME#

LOG_HOME=</span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span><span class="sh">/logs
NOHUP_LOG=</span><span class="k">${</span><span class="nv">LOG_HOME</span><span class="k">}</span><span class="sh">/nohup
tail -10f </span><span class="k">${</span><span class="nv">NOHUP_LOG</span><span class="k">}</span><span class="sh">/</span><span class="k">${</span><span class="nv">SERVER_NAME</span><span class="k">}</span><span class="sh">.out
</span><span class="no">EOF


</span><span class="nb">cp</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/startCS.sh <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/startCS1.sh
<span class="nb">cp</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/stopCS.sh <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/stopCS1.sh
<span class="nb">cp</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/logCS.sh <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/logCS1.sh
<span class="nb">cp</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/psCS.sh <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/psCS1.sh

<span class="nb">cp</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/startCS.sh <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/startCS2.sh
<span class="nb">cp</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/stopCS.sh <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/stopCS2.sh
<span class="nb">cp</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/logCS.sh <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/logCS2.sh
<span class="nb">cp</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/psCS.sh <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/psCS2.sh

<span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s|#OS_USERNAME#|</span><span class="k">${</span><span class="nv">OS_USERNAME</span><span class="k">}</span><span class="s2">|g"</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/<span class="k">*</span>CS1.sh
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s|#JAVA_HOME#|</span><span class="k">${</span><span class="nv">JAVA_HOME</span><span class="k">}</span><span class="s2">|g"</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/<span class="k">*</span>CS1.sh
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s|#DOMAIN_NAME#|</span><span class="k">${</span><span class="nv">DOMAIN_NAME</span><span class="k">}</span><span class="s2">|g"</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/<span class="k">*</span>CS1.sh
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s|#DOMAIN_HOME#|</span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span><span class="s2">|g"</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/<span class="k">*</span>CS1.sh
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s|#SERVER_NAME#|CS1|g"</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/<span class="k">*</span>CS1.sh

<span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s|#OS_USERNAME#|</span><span class="k">${</span><span class="nv">OS_USERNAME</span><span class="k">}</span><span class="s2">|g"</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/<span class="k">*</span>CS2.sh
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s|#JAVA_HOME#|</span><span class="k">${</span><span class="nv">JAVA_HOME</span><span class="k">}</span><span class="s2">|g"</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/<span class="k">*</span>CS2.sh
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s|#DOMAIN_NAME#|</span><span class="k">${</span><span class="nv">DOMAIN_NAME</span><span class="k">}</span><span class="s2">|g"</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/<span class="k">*</span>CS2.sh
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s|#DOMAIN_HOME#|</span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span><span class="s2">|g"</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/<span class="k">*</span>CS2.sh
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s|#SERVER_NAME#|CS2|g"</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/<span class="k">*</span>CS2.sh

<span class="nb">chmod </span>700 <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/<span class="k">*</span>.sh
<span class="nb">rm</span> <span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/<span class="k">*</span>CS.sh
</pre></td></tr></tbody></table></code></pre></div></div>
<p style="height:20px;"></p>
<p>Cache-Serverë¥¼ ê¸°ë™í•˜ë©´, í‘œì¤€ì¶œë ¥ logì—ì„œ ëª‡ê°€ì§€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ìš°ë¦¬ê°€ ì»¤ìŠ¤í…€í•œ ì„¤ì • íŒŒì¼ëŒ€ë¡œ ìƒì„±ì´ ëœë‹¤.</p>

<ul>
  <li>Loaded operational configuration from â€œjar:file:/sw/coherence/14c/domains/base_domain/lib/coherence.jar!/tangosol-coherence.xmlâ€</li>
  <li>Loaded operational overrides from â€œjar:file:/sw/coherence/14c/domains/base_domain/lib/coherence.jar!/tangosol-coherence-override-<strong>prod.xml</strong>â€
    <ul>
      <li>ê¸°ë³¸ê°’ <code class="language-plaintext highlighter-rouge">-Dcoherence.mode=prod</code> ê°€ ì ìš©ë˜ì–´ ìˆëŠ” ëª¨ìŠµ</li>
    </ul>
  </li>
  <li>Loaded operational overrides from â€œfile:/sw/coherence/14c/domains/base_domain/lib/<strong>tangosol-coherence-base_domain.xml</strong>â€</li>
  <li>Loaded cache configuration from â€œfile:/sw/coherence/14c/domains/base_domain/lib/<strong>session-cache-config.xml</strong>â€</li>
  <li>Created a new cluster â€œcluster_base_domainâ€ with Member(Id=1, Timestamp=2023-04-24 11:43:24.509, Address=<strong>10.65.34.245:9000</strong>, MachineId=7674, Location=site:site_base_domain,rack:rack_base_domain,machine:machine_base_domain,process:process_base_domain,member:member_base_domain, Role=CoherenceServer, Edition=Grid Edition, <strong>Mode=Production</strong>, CpuCount=4, SocketCount=1)</li>
  <li>PartitionedCache{Name=oracle.coherence.web:<strong>DistributedSessions</strong>, State=(SERVICE_STARTED), Id=4, OldestMemberId=1, <strong>LocalStorage=enabled</strong>, PartitionCount=257, BackupCount=1, AssignedPartitions=0, BackupPartitions=0, CoordinatorId=1}</li>
</ul>
<p style="height:20px;"></p>
<h3 id="33-cache-client">3.3 Cache-Client</h3>

<p>Cache-Clientë¡œ WebLogic Managed Serverë¥¼ ì‚¬ìš©í•  ê²ƒì´ë‹¤.</p>

<p>ì‚¬ì‹¤ìƒ, WebLogic ë˜í•œ Cache Serverë¡œ ë„ìš°ëŠ” ê²ƒì´ë¯€ë¡œ ìœ„ì—ì„œ ì–¸ê¸‰í•œ Managed Coherence Serverê°€ ëœë‹¤.</p>
<p style="height:20px;"></p>
<p>ë‹¤ìŒì˜ ì˜µì…˜ì„ WLS Instanceì—ì„œ ì‚¬ìš©í•œë‹¤.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="nt">-Dcoherence</span>.mode<span class="o">=</span>prod
<span class="nt">-Dcoherence</span>.override<span class="o">=</span>tangosol-coherence-<span class="k">${</span><span class="nv">DOMAIN_NAME</span><span class="k">}</span>.xml
<span class="nt">-Dcoherence</span>.session.localstorage<span class="o">=</span><span class="nb">false</span>
<span class="nt">-Dcoherence</span>.management.remote<span class="o">=</span><span class="nb">true</span>


<span class="c"># lib ì•„ë˜ jarëŠ” ìë™ ë“±ë¡ë˜ë¯€ë¡œ í•„ìš” ì—†ë‹¤, xml ì„ ìœ„í•´ ì‚¬ìš©í•œë‹¤.</span>
<span class="nv">CLASSPATH</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">CLASSPATH</span><span class="k">}</span><span class="s2">:</span><span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span><span class="s2">/lib
#CLASSPATH="</span><span class="k">${</span><span class="nv">CLASSPATH</span><span class="k">}</span>:<span class="k">${</span><span class="nv">DOMAIN_HOME</span><span class="k">}</span>/lib/coherence-web.jar
<span class="c">#CLASSPATH="${CLASSPATH}:${DOMAIN_HOME}/lib/coherence.jar</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p style="height:20px;"></p>
<p><code class="language-plaintext highlighter-rouge">-Dcoherence.cacheconfig=session-cache-config.xml</code> ì˜µì…˜ì€ ì œê±°í•˜ì˜€ê³ , í•´ë‹¹ íŒŒì¼ì€ ì•ìœ¼ë¡œ ë°°í¬í•  Web App/WEB-INF/classes ì•„ë˜ì— ì§ì ‘ ë„£ì—ˆë‹¤.</p>

<p>Application ë§ˆë‹¤ Cache êµ¬ì„±ì´ ë‹¤ë¥¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.</p>
<p style="height:20px;"></p>
<p>ê·¸ë¦¬ê³  <code class="language-plaintext highlighter-rouge">coherence.override</code> ìœ¼ë¡œ ì½ì–´ë“¤ì´ëŠ” íŒŒì¼ì€, ìœ„ì—ì„œ ì–¸ê¸‰í•˜ì˜€ëŠ”ë°, CLASSPATH ì—ì„œ ì½ìœ¼ë¯€ë¡œ <code class="language-plaintext highlighter-rouge">Web App/WEB-INF/lib</code> ì— ë„£ì„ ê²½ìš°, ê²€ìƒ‰í•˜ëŠ” CLASSLOADì™€ ê´€ë ¨ëœ ë¬¸ì œ ì¸ì§€ ì½ì„ ìˆ˜ ì—†ë‹¤, ì–´ì°¨í”¼ Server ë°°í¬ íŒŒì¼ì´ë¯€ë¡œ Appì— ë„£ëŠ” ê²½ìš°ë„ ì—†ì„ ê²ƒì´ë‹¤.</p>
<p style="height:20px;"></p>
<p>ì¸ìŠ¤í„´ìŠ¤ ê¸°ë™ ì‹œì—, ë³„ë‹¤ë¥¸ Logê°€ ê¸°ë¡ë˜ì§€ ì•ŠëŠ”ë‹¤.</p>

<p><a href="#h-34-web-app-ë°°í¬">3.4 Web-App ë°°í¬</a> ì‹œì— Logê°€ ì¶œë ¥ë˜ì—ˆë‹¤.</p>
<p style="height:20px;"></p>
<h3 id="34-web-app-ë°°í¬">3.4 Web-App ë°°í¬</h3>

<ul>
  <li>
    <p>session-cache-config.xml ë°°ì¹˜ êµ¬ì„±ë„.</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>tree &lt;WEB-APP&gt;/WEB-INF/
&lt;WEB-APP&gt;/WEB-INF/
â”œâ”€â”€ classes
â”‚Â Â  â””â”€â”€ session-cache-config.xml
â”œâ”€â”€ weblogic.xml
â””â”€â”€ web.xml
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>weblogic.xml êµ¬ì„±</p>
    <ul>
      <li>timeout-secs : Weblogic Sessionì˜ ìœ íš¨ ê¸°ê°„</li>
      <li>invalidation-interval-secs : Coherence Session Reaper Threadê°€ 60ì´ˆë§ˆë‹¤ ì‹¤í–‰ëœë‹¤.</li>
      <li>persistent-store-type : coherence-web</li>
    </ul>
  </li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>    <span class="nt">&lt;container-descriptor&gt;</span>
        <span class="nt">&lt;servlet-reload-check-secs&gt;</span>1<span class="nt">&lt;/servlet-reload-check-secs&gt;</span>
        <span class="nt">&lt;resource-reload-check-secs&gt;</span>1<span class="nt">&lt;/resource-reload-check-secs&gt;</span>
    <span class="nt">&lt;/container-descriptor&gt;</span>

    <span class="nt">&lt;jsp-descriptor&gt;</span>
        <span class="nt">&lt;page-check-seconds&gt;</span>1<span class="nt">&lt;/page-check-seconds&gt;</span>
    <span class="nt">&lt;/jsp-descriptor&gt;</span>

    <span class="nt">&lt;session-descriptor&gt;</span>
        <span class="nt">&lt;timeout-secs&gt;</span>30<span class="nt">&lt;/timeout-secs&gt;</span>
        <span class="nt">&lt;invalidation-interval-secs&gt;</span>60<span class="nt">&lt;/invalidation-interval-secs&gt;</span>
        <span class="nt">&lt;persistent-store-type&gt;</span>coherence-web<span class="nt">&lt;/persistent-store-type&gt;</span>
    <span class="nt">&lt;/session-descriptor&gt;</span>
<span class="nt">&lt;/weblogic-web-app&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p style="height:20px;"></p>
<p>Appì„ Deploy ì‹œì— Log</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>&lt;Module coh14cApp of application coh14cApp is transitioning from STATE_NEW to STATE_PREPARED on server M1.&gt;

... Loaded operational configuration from <span class="s2">"jar:file:/sw/weblogic/14c/coherence/lib/coherence.jar!/tangosol-coherence.xml"</span>

... Loaded operational overrides from <span class="s2">"jar:file:/sw/weblogic/14c/coherence/lib/coherence.jar!/tangosol-coherence-override-prod.xml"</span>

... Loaded operational overrides from <span class="s2">"file:/sw/weblogic/14c/domains/base_domain/lib/tangosol-coherence-base_domain.xml"</span>

Oracle Coherence Version 14.1.1.0.0 Build 77467
 Grid Edition: Production mode
Copyright <span class="o">(</span>c<span class="o">)</span> 2000, 2020, Oracle and/or its affiliates. All rights reserved.

... Loaded cache configuration from <span class="s2">"file:/sw/app/coh14cApp/WEB-INF/classes/session-cache-config.xml"</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p style="height:20px;"></p>
<p>Appì„ Runtime Serviceë¡œ ì‹œì‘ì‹œì— Log.</p>

<p>ê¸°ì¡´(Senior) Memberìœ¼ë¡œ Joined ë˜ëŠ” ê³¼ì •</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>&lt;Module coh14cApp of application coh14cApp is transitioning from STATE_PREPARED to STATE_ADMIN on server M1.&gt;

...  Member<span class="o">(</span><span class="nv">Id</span><span class="o">=</span>1, <span class="nv">Timestamp</span><span class="o">=</span>2023-04-24 11:43:24.509, <span class="nv">Address</span><span class="o">=</span>10.65.34.245:9000, <span class="nv">MachineId</span><span class="o">=</span>7674, <span class="nv">Location</span><span class="o">=</span>site:site_base_domain,rack:rack_base_domain,machine:machine_base_domain,process:process_base_domain,member:member_base_domain, <span class="nv">Role</span><span class="o">=</span>CoherenceServer<span class="o">)</span> joined Cluster with senior member 1
 
... This Member<span class="o">(</span><span class="nv">Id</span><span class="o">=</span>2, <span class="nv">Timestamp</span><span class="o">=</span>2023-04-24 12:05:26.569, <span class="nv">Address</span><span class="o">=</span>10.65.34.245:9002, <span class="nv">MachineId</span><span class="o">=</span>7674, <span class="nv">Location</span><span class="o">=</span>site:site_base_domain,rack:rack_base_domain,machine:machine_base_domain,process:process_base_domain,member:member_base_domain, <span class="nv">Role</span><span class="o">=</span>CoherenceServer, <span class="nv">Edition</span><span class="o">=</span>Grid Edition, <span class="nv">Mode</span><span class="o">=</span>Production, <span class="nv">CpuCount</span><span class="o">=</span>4, <span class="nv">SocketCount</span><span class="o">=</span>1<span class="o">)</span> joined cluster <span class="s2">"cluster_base_domain"</span> with senior Member<span class="o">(</span><span class="nv">Id</span><span class="o">=</span>1, <span class="nv">Timestamp</span><span class="o">=</span>2023-04-24 11:43:24.509, <span class="nv">Address</span><span class="o">=</span>10.65.34.245:9000, <span class="nv">MachineId</span><span class="o">=</span>7674, <span class="nv">Location</span><span class="o">=</span>site:site_base_domain,rack:rack_base_domain,machine:machine_base_domain,process:process_base_domain,member:member_base_domain, <span class="nv">Role</span><span class="o">=</span>CoherenceServer, <span class="nv">Edition</span><span class="o">=</span>Grid Edition, <span class="nv">Mode</span><span class="o">=</span>Production, <span class="nv">CpuCount</span><span class="o">=</span>4, <span class="nv">SocketCount</span><span class="o">=</span>1<span class="o">)</span>

... Service TransportService is bound to tmb://10.65.34.245:9002.47964

... Service TransportService joined the cluster with senior service member 1

... Connection established with tmb://10.65.34.245:9000.44385
</pre></td></tr></tbody></table></code></pre></div></div>
<p style="height:20px;"></p>
<p>Cache Configê°€ êµ¬ì„± ë˜ì—ˆë‹¤ëŠ” Log</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre>&lt;Configured session model <span class="s2">"SplitHttpSessionCollection"</span>:
  Clustered Session Cache <span class="nv">Name</span><span class="o">=</span>session-storage
  Local Session Cache <span class="nv">Name</span><span class="o">=</span>local-session-storage
  Local Session Attribute Cache <span class="nv">Name</span><span class="o">=</span>local-attribute-storage
  SessionDistributionController Class <span class="nv">Name</span><span class="o">=</span>
  AttributeScopeController Class <span class="nv">Name</span><span class="o">=</span>com.tangosol.coherence.servlet.AbstractHttpSessionCollection<span class="nv">$ApplicationScopeController</span>
  Maximum Session Inactive <span class="nv">Seconds</span><span class="o">=</span>30
  Session ID Character <span class="nv">Length</span><span class="o">=</span>52
  Session Get Lock <span class="nv">Timeout</span><span class="o">=</span>300
  Suspect Attribute <span class="nv">Detection</span><span class="o">=</span><span class="nb">true
  </span>Strict <span class="s2">"Servlet Specification"</span> Exception <span class="nv">Handling</span><span class="o">=</span><span class="nb">true
  </span>Sticky Session <span class="nv">Ownership</span><span class="o">=</span><span class="nb">false
  </span>Sticky Session Ownership Service <span class="nv">Name</span><span class="o">=</span>SessionOwnership
  Assume Session Locality <span class="k">for </span><span class="nv">Reaping</span><span class="o">=</span><span class="nb">false
  </span>Parallel Session <span class="nv">Reaping</span><span class="o">=</span><span class="nb">false
  </span>Allow Local <span class="nv">Attributes</span><span class="o">=</span><span class="nb">false
  </span>Use Default Session ID <span class="nv">Decoding</span><span class="o">=</span><span class="nb">true
  </span>Use Default Session ID <span class="nv">Encoding</span><span class="o">=</span><span class="nb">false
  </span>Session ID Affinity <span class="nv">Token</span><span class="o">=</span>null
  Session ID Replace Affinity <span class="nv">Token</span><span class="o">=</span><span class="nb">false
  </span>Session Expiry Filter <span class="nv">Factory</span><span class="o">=</span>
  Session Access Debug Logging <span class="nv">Enabled</span><span class="o">=</span><span class="nb">false
  </span>Session Access Debug Logging <span class="nv">Filter</span><span class="o">=</span>
  Session Locking <span class="nv">Mode</span><span class="o">=</span>none
  Session Reaping <span class="nv">Mechanism</span><span class="o">=</span>Default&gt;
</pre></td></tr></tbody></table></code></pre></div></div>
<p style="height:20px;"></p>
<p>MBean ì— ë“±ë¡ëœë‹¤.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>INFO: Registering MBean using object name <span class="s2">"type=WebLogicHttpSessionManager,nodeId=2,appId=coh14cAppcoh14cApp"</span>
2023-04-24 12:05:28.831/473.137 Oracle Coherence GE 14.1.1.0.0 &lt;Info&gt; <span class="o">(</span><span class="nv">thread</span><span class="o">=[</span>STANDBY] ExecuteThread: <span class="s1">'3'</span> <span class="k">for </span>queue: <span class="s1">'weblogic.kernel.Default (self-tuning)'</span>, <span class="nv">member</span><span class="o">=</span>2<span class="o">)</span>: Registering MBean using object name <span class="s2">"type=WebLogicHttpSessionManager,nodeId=2,appId=coh14cAppcoh14cApp"</span>
</pre></td></tr></tbody></table></code></pre></div></div>

:ET