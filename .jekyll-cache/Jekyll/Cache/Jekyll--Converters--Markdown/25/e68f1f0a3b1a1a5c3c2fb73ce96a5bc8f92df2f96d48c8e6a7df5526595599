I"õ.<h2 id="1-overview">1. Overview</h2>

<p>Outlookì—ì„œ ì¤‘ìš”í•œ ì´ë©”ì¼ì„ ë°›ìœ¼ë©´, ì•Œë¦¼ì´ ìš¸ë¦¬ë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆì§€ë§Œ, ë°˜ë³µì ìœ¼ë¡œ ì‚¬ìš©ìê°€ ì»´í“¨í„° ì•ì— ë„ì°©í•  ë•Œê¹Œì§€ ìš¸ë¦¬ì§€ ì•ŠëŠ”ë‹¤.</p>

<p>ê¼­ ìˆ˜ì‹ ë°›ì•„ì•¼ í•˜ëŠ” ì´ë©”ì¼ì´ ì™”ì„ ê²½ìš°ë¥¼ ìœ„í•˜ì—¬ ë°˜ë³µì ìœ¼ë¡œ ì‚¬ìš´ë“œ íŒŒì¼ì„ ì¬ìƒí•˜ë„ë¡ í•œë‹¤.</p>
<p style="height:40px;"></p>
<h2 id="2-description">2. Description</h2>

<h3 id="21-class-module">2.1 Class Module</h3>

<p>VBA í´ë˜ìŠ¤ ëª¨ë“ˆì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="k">Private</span> <span class="k">WithEvents</span> <span class="n">objInspectors</span> <span class="ow">As</span> <span class="n">Outlook</span><span class="p">.</span><span class="n">Inspectors</span>
<span class="k">Private</span> <span class="k">WithEvents</span> <span class="n">objMailItem</span> <span class="ow">As</span> <span class="n">Outlook</span><span class="p">.</span><span class="n">MailItem</span>

<span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Application_Startup</span><span class="p">()</span>
    <span class="k">Set</span> <span class="n">objInspectors</span> <span class="o">=</span> <span class="n">Application</span><span class="p">.</span><span class="n">Inspectors</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Private</span> <span class="k">Sub</span> <span class="nf">objInspectors_NewInspector</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">Inspector</span> <span class="ow">As</span> <span class="n">Inspector</span><span class="p">)</span>
    <span class="k">If</span> <span class="n">Inspector</span><span class="p">.</span><span class="n">CurrentItem</span><span class="p">.</span><span class="n">Class</span> <span class="o">=</span> <span class="n">olMail</span> <span class="k">Then</span>
        <span class="k">Set</span> <span class="n">objMailItem</span> <span class="o">=</span> <span class="n">Inspector</span><span class="p">.</span><span class="n">CurrentItem</span>
    <span class="k">End</span> <span class="k">If</span>
<span class="k">End</span> <span class="k">Sub</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p style="height:40px;"></p>
<h3 id="22-thisoutlooksession">2.2 ThisOutlookSession</h3>

<p>ThisOutlookSession ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre></td><td class="rouge-code"><pre><span class="k">Private</span> <span class="k">Declare</span> <span class="n">PtrSafe</span> <span class="k">Function</span> <span class="nf">PlaySound</span> <span class="k">Lib</span> <span class="s">"winmm.dll"</span> <span class="k">Alias</span> <span class="s">"PlaySoundA"</span> <span class="p">(</span><span class="k">ByVal</span> <span class="n">lpszName</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">hModule</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">dwFlags</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Long</span>

<span class="k">Private</span> <span class="k">Const</span> <span class="nv">SND_ASYNC</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H1</span>
<span class="k">Private</span> <span class="k">Const</span> <span class="nv">SND_LOOP</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">H8</span>

<span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Application_NewMail</span><span class="p">()</span>
    <span class="c1">'Check_NewMail Application.Session.GetDefaultFolder(olFolderInbox)</span>
    <span class="n">Check_NewMail</span> <span class="n">Application</span><span class="p">.</span><span class="n">Session</span><span class="p">.</span><span class="n">GetDefaultFolder</span><span class="p">(</span><span class="n">olFolderInbox</span><span class="p">).</span><span class="n">Folders</span><span class="p">(</span><span class="s">"TAS"</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Check_NewMail</span><span class="p">(</span><span class="n">objInBox</span> <span class="ow">As</span> <span class="n">Outlook</span><span class="p">.</span><span class="n">MAPIFolder</span><span class="p">)</span>
    <span class="k">Dim</span> <span class="nv">objMail</span> <span class="ow">As</span> <span class="kt">Object</span>
    <span class="k">Dim</span> <span class="nv">receivedHour</span> <span class="ow">As</span> <span class="kt">Integer</span>
    <span class="k">Dim</span> <span class="nv">receivedDay</span> <span class="ow">As</span> <span class="kt">Integer</span>
    
    <span class="k">For</span> <span class="k">Each</span> <span class="n">objMail</span> <span class="ow">In</span> <span class="n">objInBox</span><span class="p">.</span><span class="n">Items</span> <span class="c1">' ìµœê·¼ ë©”ì¼ë¶€í„° ê°€ì ¸ì˜´</span>
               
        <span class="c1">' ì•ˆì½ì€ ì´ë©”ì¼ë§Œ ì²´í¬</span>
        <span class="k">If</span> <span class="n">objMail</span><span class="p">.</span><span class="n">UnRead</span> <span class="o">=</span> <span class="k">True</span> <span class="k">Then</span>
        
            <span class="c1">' ë„ì°©í•œ ë©”ì¼ì˜ ìš”ì¼</span>
            <span class="n">receivedDay</span> <span class="o">=</span> <span class="n">Weekday</span><span class="p">(</span><span class="n">objMail</span><span class="p">.</span><span class="n">ReceivedTime</span><span class="p">)</span>
            <span class="c1">' ë„ì°©í•œ ë©”ì¼ì˜ ì‹œê°„</span>
            <span class="n">receivedHour</span> <span class="o">=</span> <span class="k">CInt</span><span class="p">(</span><span class="n">Format</span><span class="p">(</span><span class="n">objMail</span><span class="p">.</span><span class="n">ReceivedTime</span><span class="p">,</span> <span class="s">"HH"</span><span class="p">))</span>

            <span class="c1">' ê¸ˆìš”ì¼ 18ì‹œ ì´í›„, í† /ì¼ ì „ì²´ ì‹œê°„ëŒ€, ì›”ìš”ì¼ 09ì‹œ ì´ì „ ë©”ì¼ì¸ì§€ í™•ì¸</span>
            <span class="k">If</span> <span class="p">(</span><span class="n">receivedDay</span> <span class="o">=</span> <span class="n">vbFriday</span> <span class="ow">And</span> <span class="n">receivedHour</span> <span class="o">&gt;=</span> <span class="mi">18</span><span class="p">)</span> <span class="n">_</span>
            <span class="ow">Or</span> <span class="p">(</span><span class="n">receivedDay</span> <span class="o">=</span> <span class="n">vbMonday</span> <span class="ow">And</span> <span class="n">receivedHour</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">)</span> <span class="n">_</span>
            <span class="ow">Or</span> <span class="p">(</span><span class="n">receivedDay</span> <span class="o">=</span> <span class="n">vbSaturday</span> <span class="ow">Or</span> <span class="n">receivedDay</span> <span class="o">=</span> <span class="n">vbSunday</span><span class="p">)</span> <span class="k">Then</span>
                    <span class="c1">' Body ì—ì„œ "status: new" í…ìŠ¤íŠ¸ë¥¼ í™•ì¸</span>
                    <span class="k">If</span> <span class="n">InStr</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">LCase</span><span class="p">(</span><span class="n">objMail</span><span class="p">.</span><span class="n">Body</span><span class="p">),</span> <span class="s">"status: new"</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">Then</span>
                        <span class="n">PlaySoundLoop</span>
                    <span class="k">End</span> <span class="k">If</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">End</span> <span class="k">If</span>
    <span class="k">Next</span> <span class="n">objMail</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Private</span> <span class="k">Sub</span> <span class="nf">PlaySoundLoop</span><span class="p">()</span>
    <span class="c1">' ì—¬ê¸°ì— ì‚¬ìš´ë“œ íŒŒì¼ ê²½ë¡œë¥¼ ì§€ì •</span>
    <span class="k">Dim</span> <span class="nv">soundFile</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">soundFile</span> <span class="o">=</span> <span class="s">"C:\Windows\Media\Windows Ringin.wav"</span>
    
    <span class="k">Do</span>
        <span class="n">PlaySound</span> <span class="n">soundFile</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SND_ASYNC</span> <span class="ow">Or</span> <span class="n">SND_LOOP</span>
        <span class="n">DoEvents</span> <span class="c1">' ë‹¤ë¥¸ ì´ë²¤íŠ¸ ì²˜ë¦¬ë¥¼ ìœ„í•œ ì½”ë“œ</span>
    <span class="k">Loop</span> <span class="n">Until</span> <span class="p">(</span><span class="n">MsgBox</span><span class="p">(</span><span class="s">"Press OK to stop the sound."</span><span class="p">,</span> <span class="n">vbOKOnly</span><span class="p">,</span> <span class="s">"Stop Sound"</span><span class="p">)</span> <span class="o">=</span> <span class="n">vbOK</span><span class="p">)</span>
    
    <span class="c1">' ì‚¬ìš©ìê°€ í™•ì¸ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì‚¬ìš´ë“œ ì¤‘ì§€</span>
    <span class="n">PlaySound</span> <span class="n">vbNullString</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SND_ASYNC</span> <span class="c1">' ì‚¬ìš´ë“œ ì¤‘ì§€</span>
<span class="k">End</span> <span class="k">Sub</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p style="height:20px;"></p>
<p><code class="language-plaintext highlighter-rouge">Private Declare PtrSafe</code> VBA 7.1, Windows 11 64bit í™˜ê²½ì´ë¯€ë¡œ í•„ìš”í•œ ì„ ì–¸ë¶€</p>
<p style="height:20px;"></p>
<p><code class="language-plaintext highlighter-rouge">GetDefaultFolder(olFolderInbox)</code> ê¸°ë³¸ ìˆ˜ì‹ í•¨(Inbox) ì™¸ì—ë„</p>

<p><code class="language-plaintext highlighter-rouge">Folders("TAS")</code> Inbox í•˜ìœ„ì— TAS í´ë” ë˜í•œ ë³´ê¸° ìœ„í•˜ì—¬ ì„¤ì •í•˜ì˜€ë‹¤.</p>

<p>ë©”ì¼ì— ìë™ ê·œì¹™ìœ¼ë¡œ ìë™ ë¶„ë¥˜ê°€ ë˜ë©´, ê¸°ë³¸ ìˆ˜ì‹ í•¨ì— ë„ì°©í•˜ì§€ ì•Šê³  ë°”ë¡œ TASì— ê°€ê¸° ë•Œë¬¸ì— ë°˜ë“œì‹œ í•„ìš”í–ˆë‹¤.</p>
<p style="height:20px;"></p>
<p><code class="language-plaintext highlighter-rouge">For Each objMail In objInBox.Items</code> ê¸°ë³¸ì ìœ¼ë¡œ ë©”ì¼ì˜ ìµœê·¼ ëª©ë¡ë¶€í„° ê³¼ê±°ë¡œ ê°€ì ¸ì˜¨ë‹¤ê³  í•˜ì§€ë§Œ, ê·¸ë ‡ì§€ ì•Šì€ ê²ƒ ê°™ë‹¤.</p>
<p style="height:20px;"></p>
<p><code class="language-plaintext highlighter-rouge">If (receivedDay = vbFriday And receivedHour &gt;= 18) _
Or (receivedDay = vbMonday And receivedHour &lt;= 9) _
Or (receivedDay = vbSaturday Or receivedDay = vbSunday) Then</code>  ì¶”ì í•˜ë ¤ëŠ” ë©”ì¼ì€ í‰ì¼ì´ ì•„ë‹Œ, ê¸ˆìš”ì¼ 18ì‹œ ì´í›„ ì›”ìš”ì¼ 09ì‹œ ì´ì „ ì‚¬ì´ì— ë„ì°©í•˜ëŠ” ë©”ì¼ì´ë‹¤.</p>
<p style="height:20px;"></p>
<p><code class="language-plaintext highlighter-rouge">InStr(1, LCase(objMail.Body), "status: new")</code> ì´ë©”ì¼ ë³¸ë¬¸ì„ ì†Œë¬¸ìë¡œ ë³€í™˜í•˜ê³ , â€˜status: newâ€™ ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤.</p>
<p style="height:40px;"></p>
<h2 id="3-references">3. References</h2>

<p>ChatGPT ë„ì›€ìœ¼ë¡œ í•´ê²°í•¨</p>
:ET